# 老系统相关api文档

#### 简要说明：
> 此文档主要用于在对接老系统相关接口时参考使用。

## 1.基本信息
1. 服务器host:  http://www.kuaifazs.com
2. secretkey: 5xxxxxxxxxxxxxxxxxxxxxxx0d
3. 请求方式：GET
4. 响应: json

| 参数名称        | 类型            | 说明                        |
| --------------- |:---------------:| ---------------------------:|
| status          | string          | 状态码，0为成功             |
| error           | string          | 错误码                      |
| error_message   | string          | 错误描述                    |
| data            | interface       | 返回的数据                  |

## 2.sign生成
1. 对所有参数按照参数(除了sign外)名字母升序排列，sign参数不参与签名。
2. 排序完成之后，再把所有参数和值以“&”字符连接起来。
3. 做一次md5处理，得到的加密串1；
4. 在加密串1末尾追加secretkey，做一次md5加密，得到的字符串就是签名sign的值。


## 3.获取游戏列表

>url:/forgoapi/game/list

| 参数名称        | 类型            | 必填  | 说明                                   |
| --------------- |:---------------:| -----:| --------------------------------------:|
| game_id         | int             | 是    | 游戏id,(返回结果获取大于game_id的数据) |
| timestamp       | int             | 是    | 时间戳，每次请求必须是最新的           |
| sign            | string          | 是    | 参见2.sign生成                         |

## 4.获取渠道列表

>url:/forgoapi/game/list

| 参数名称        | 类型            | 必填  | 说明                                      |
| --------------- |:---------------:| -----:| -----------------------------------------:|
| channel_id      | int             | 是    | 渠道id,(返回结果获取大于channel_id的数据) |
| timestamp       | int             | 是    | 时间戳，每次请求必须是最新的              |
| sign            | string          | 是    | 参见2.sign生成                            |


## 5.按天获取数据汇总

>url:/forgoapi/order/daydata

| 参数名称        | 类型            | 必填  | 说明                                      |
| --------------- |:---------------:| -----:| -----------------------------------------:|
| date            | stirng          | 是    | 日期时间 格式 Y-m-d                       |
| timestamp       | int             | 是    | 时间戳，每次请求必须是最新的              |
| sign            | string          | 是    | 参见2.sign生成                            |


## 6.按游戏日期获取导出链接

>url:/forgoapi/order/export

| 参数名称        | 类型            | 必填  | 说明                                      |
| --------------- |:---------------:| -----:| -----------------------------------------:|
| start           | stirng          | 是    | 日期时间 格式 Y-m-d                       |
| end             | stirng          | 是    | 日期时间 格式 Y-m-d                       |
| game_id         | int             | 是    | 游戏id                                    |
| cp              | string          | 否    | 渠道编码 (不传则导出该游戏全渠道数据)     |
| timestamp       | int             | 是    | 时间戳，每次请求必须是最新的              |
| sign            | string          | 是    | 参见2.sign生成                            |



## 7.获取阶梯数据

>url:/forgoapi/allotrule/getlist

| 参数名称        | 类型            | 必填  | 说明                                      |
| --------------- |:---------------:| -----:| -----------------------------------------:|
| game_id         | int             | 是    | 游戏id                                    |
| cp              | string          | 否    | 渠道编码 (不传则认为设置上游合同阶梯规则)     |
| timestamp       | int             | 是    | 时间戳，每次请求必须是最新的              |
| sign            | string          | 是    | 参见2.sign生成                            |



## 8.修改新增阶梯数据

>url:/forgoapi/allotrule/update

| 参数名称        | 类型            | 必填  | 说明                                      |
| --------------- |:---------------:| -----:| -----------------------------------------:|
| data            | json            | 是    | 例子：[{"id":0,"start":"2017-01-01","end":"2018-12-31","ratio":50,"slotting_fee":5.8,"rule":"10000\<user\<20000&1480212121\<time\<1481212121"}], id:规则id,0为新增;ratio:我方比例;slotting_fee:通道费;rule:规则，使用&分割条件，目前只支持user、time、money条件类型，数值与条件类型间必须由"<"分割        |
| game_id         | int             | 是    | 游戏id                                    |
| cp              | string          | 否    | 渠道编码 (不传则认为设置上游合同阶梯规则)     |
| timestamp       | int             | 是    | 时间戳，每次请求必须是最新的              |
| sign            | string          | 是    | 参见2.sign生成                            |



## 9.获取月结数据

>url:/forgoapi/order/clearing



| 参数名称        | 类型            | 必填  | 说明                                      |
| --------------- |:---------------:| -----:| -----------------------------------------:|
| month           | stirng          | 是    | 日期时间 格式 Y-m                     |
| game_id         | int             | 是    | 游戏id                                    |
| cp              | string          | 否    | 渠道编码 (不传则认为设置上游合同阶梯规则)     |
| timestamp       | int             | 是    | 时间戳，每次请求必须是最新的              |
| sign            | string          | 是    | 参见2.sign生成                            |